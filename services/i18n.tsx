import React, { createContext, useContext, useState, ReactNode } from 'react';

type Language = 'en' | 'th' | 'cn';

interface LanguageContextType {
  language: Language;
  setLanguage: (lang: Language) => void;
  t: (key: string) => string;
}

const translations: Record<Language, Record<string, string>> = {
  en: {
    // Categories
    'nav.overview': 'System Overview',
    'nav.sales': 'Sales & Planning',
    'nav.production': 'Production Line',
    'nav.warehouse': 'Warehouse & Shipping',
    'nav.management': 'Management & Analysis',
    'nav.welcome': 'Welcome',

    // Sub-menus
    'nav.dashboard': 'Dashboard',
    
    // Sales
    'nav.customers': 'Customer Management',
    'nav.orders': 'Production Plan (List)',
    'nav.poDocs': 'Create Production Order (Doc)',
    
    // Production
    'nav.machineStatus': 'Machine Status',
    'nav.kanban': 'Production Kanban',
    'nav.prodLogs': 'Production Logs (Molding)',
    
    // Warehouse
    'nav.qc': 'Quality Control (QC)',
    'nav.finishedGoods': 'Finished Goods Stock',
    'nav.rawMaterials': 'Raw Materials / BOM',
    'nav.products': 'Product Management',
    'nav.shipping': 'Shipping Management',
    'nav.complaints': 'Customer Complaints',
    
    // Management
    'nav.employees': 'Employee Management',
    'nav.maintenance': 'Machine Maintenance',
    'nav.purchasing': 'Purchasing',
    'nav.analysisMat': 'Material Analysis',
    'nav.analysisCost': 'Cost Analysis',
    'nav.analysisProfit': 'Profit Analysis',
    'nav.oee': 'Machine Efficiency (OEE)',
    'nav.reports': 'General Reports',
    'nav.settings': 'System Settings',

    // Placeholder Page
    'common.comingSoon': 'Coming Soon',
    'common.underConstruction': 'This module is under development.',

    // Settings
    'set.title': 'System Settings',
    'set.subtitle': 'Manage application configuration and company details.',
    'set.companyProfile': 'Company Info',
    'set.companyName': 'Company Name',
    'set.companyAddress': 'Address',
    'set.taxId': 'Tax ID',
    'set.logoUrl': 'Logo URL',
    'set.changeLogo': 'Change Logo',
    'set.qcReasons': 'QC Failure Reasons',
    'set.addReason': 'Add new reason',
    'set.prodSteps': 'Production Steps',
    'set.addStep': 'Add new step',
    'set.machineStatus': 'Machine Statuses',
    'set.addStatus': 'Add new status',
    'set.general': 'General Settings',
    'set.regrind': 'Regrind Percentage (%)',
    'set.oeeHours': 'Working Hours (for OEE)',
    'set.roles': 'User Roles / Departments',
    'set.addRole': 'Add new role',
    'set.overhead': 'Overhead Costs',
    'set.addOverhead': 'Add Item',
    'set.totalPerHour': 'Total per Hour',
    'set.depreciation': 'Machine Depreciation',
    'set.addDepreciation': 'Add Item',
    'set.dataManagement': 'Data Management',
    'set.import': 'Import Data (JSON)',
    'set.export': 'Export Data (JSON)',
    'set.saveAll': 'Save All Changes',
    'set.saveSuccess': 'Settings saved successfully!',
    'set.newItemPlaceholder': 'New Item...',
    'set.costName': 'Item Name',
    'set.costValue': 'Cost',

    // Common & Tables
    'orders.quantity': 'Quantity',
    'qc.on': 'on',
    'orders.status': 'Status',
    'qc.inspectedBy': 'Inspected by',
    'qc.pass': 'Pass',
    'qc.fail': 'Fail',
    'qc.sourceDate': 'Source Date',
    'inv.itemName': 'Item Name',
    'inv.unit': 'Unit',
    'inv.costUnit': 'Cost/Unit',
    'inv.status': 'Status',
    'inv.inStock': 'In Stock',
    'inv.lowStock': 'Low Stock',
    'inv.outOfStock': 'Out of Stock',
    'prod.poNumber': 'PO Number',
    'prod.productDetail': 'Product Detail',
    'prod.target': 'Target',
    'prod.produced': 'Produced',
    'prod.progress': 'Progress',
    'prod.dailyLog': 'Daily Log',
    'prod.dailyLogSub': 'Daily Report',
    'prod.outputToday': 'Output Today',
    'prod.shift': 'Shift',
    'emp.name': 'Name',
    'emp.department': 'Department',
    'emp.dailyWage': 'Daily Wage',
    'emp.hireDate': 'Hire Date',
    'dash.totalOrders': 'Total Orders',
    'dash.activeMachines': 'Active Machines',
    'dash.totalProduction': 'Total Production',
    'dash.pendingQC': 'Pending QC',
    'dash.productionVolume': 'Production Volume',
    'dash.qcStatus': 'QC Status',
    'dash.recentLogs': 'Recent Logs',
    'dash.ofTotal': 'of total',
    'orders.title': 'Orders',
    'orders.subtitle': 'Manage orders',
    'orders.search': 'Search',
    'orders.filter': 'Filter',
    'orders.lotNo': 'Lot No',
    'orders.productName': 'Product Name',
    'orders.color': 'Color',
    'orders.dueDate': 'Due Date',
    'orders.noFound': 'No orders found',
    'prod.title': 'Production',
    'prod.subtitle': 'Manage production',
    'prod.activeSummary': 'Active Summary',
    'prod.noActive': 'No active orders',
    'prod.noLogs': 'No logs',
    'inv.title': 'Inventory',
    'inv.subtitle': 'Manage stock',
    'inv.searchFinished': 'Search Finished',
    'inv.searchRaw': 'Search Raw',
    'qc.title': 'QC',
    'qc.subtitle': 'Manage QC',
    'emp.title': 'Employees',
    'emp.subtitle': 'Manage employees',

    // Machine Status Specific
    'mach.subtitle': 'Real-time production monitoring & control',
    'mach.maintSubtitle': 'Maintenance schedules and history',
    'mach.running': 'Running',
    'mach.idle': 'Idle',
    'mach.error': 'Error',
    'mach.maintenance': 'Maintenance',
    'mach.machineIdle': 'Machine is Idle',
    'mach.ready': 'Ready for assignment',
    'mach.lastActive': 'Last active',
    'mach.assign': 'Assign',
    'mach.log': 'Log',
    'mach.settings': 'Status',
    'mach.modalAssign': 'Assign Job',
    'mach.modalLog': 'Log Output',
    'mach.modalStatus': 'Machine Status',
    'mach.selectOrder': 'Select Production Order',
    'mach.operator': 'Operator',
    'mach.selectOp': 'Select Operator...',
    'mach.currentJob': 'Current Job',
    'mach.goodQty': 'Good Quantity',
    'mach.rejectQty': 'Reject Quantity',
    'mach.setStatus': 'Set Machine Status',
    'mach.cancel': 'Cancel',
    'mach.confirm': 'Confirm Action',
    'mach.noOrders': 'No open orders available.',
    'mach.statusRun': 'Running / Working',
    'mach.statusIdle': 'Idle / Waiting',
    'mach.statusMaint': 'Maintenance',
    'mach.statusError': 'Error / Breakdown',
    'mach.runningNoJob': 'Machine Running, No Job',
    'mach.assignNow': 'Assign Job Now',

    // PO Doc
    'po.title': 'Production Orders',
    'po.subtitle': 'Create formal production documents for approval',
    'po.create': 'Create New Order',
    'po.docNo': 'Doc No.',
    'po.date': 'Date',
    'po.customer': 'Customer / Dept',
    'po.items': 'Items',
    'po.print': 'Print Order',
    'po.formTitle': 'Production Order Form',
    'po.addItem': 'Add Item',
    'po.note': 'Note',
    'po.sign.ordered': 'Ordered By',
    'po.sign.approved': 'Approved By',
    'po.sign.received': 'Received By',
    'po.docHeader': 'PRODUCTION ORDER',
  },
  th: {
    // Categories
    'nav.overview': 'ภาพรวมระบบ',
    'nav.sales': 'การขายและวางแผน',
    'nav.production': 'สายการผลิต',
    'nav.warehouse': 'คลังสินค้าและการจัดส่ง',
    'nav.management': 'การจัดการและวิเคราะห์',
    'nav.welcome': 'ยินดีต้อนรับ',

    // Sub-menus
    'nav.dashboard': 'แดชบอร์ด',
    'nav.customers': 'จัดการลูกค้า',
    'nav.orders': 'แผนการผลิต / ออเดอร์',
    'nav.poDocs': 'ใบสั่งผลิต (เอกสาร)',
    'nav.machineStatus': 'สถานะเครื่องฉีด',
    'nav.kanban': 'สายการผลิต (Kanban)',
    'nav.prodLogs': 'บันทึกการผลิต (ฉีด)',
    'nav.qc': 'ควบคุมคุณภาพ (QC)',
    'nav.finishedGoods': 'สต็อกสินค้าสำเร็จรูป',
    'nav.rawMaterials': 'วัตถุดิบ / BOM',
    'nav.products': 'จัดการสินค้า',
    'nav.shipping': 'จัดส่งสินค้า',
    'nav.complaints': 'ข้อร้องเรียน',
    'nav.employees': 'จัดการพนักงาน',
    'nav.maintenance': 'ซ่อมบำรุงเครื่องจักร',
    'nav.purchasing': 'การจัดซื้อ',
    'nav.analysisMat': 'วิเคราะห์วัตถุดิบ',
    'nav.analysisCost': 'วิเคราะห์ต้นทุน',
    'nav.analysisProfit': 'วิเคราะห์กำไร',
    'nav.oee': 'ประสิทธิภาพเครื่องจักร',
    'nav.reports': 'รายงาน',
    'nav.settings': 'ตั้งค่าระบบ',

    // Placeholder
    'common.comingSoon': 'เร็วๆ นี้',
    'common.underConstruction': 'ส่วนนี้กำลังอยู่ในระหว่างการพัฒนาตามแผนงาน',

    // Settings
    'set.title': 'ตั้งค่าระบบ',
    'set.subtitle': 'จัดการข้อมูลบริษัทและการตั้งค่าพื้นฐาน',
    'set.companyProfile': 'ข้อมูลบริษัท',
    'set.companyName': 'ชื่อบริษัท',
    'set.companyAddress': 'ที่อยู่',
    'set.taxId': 'เลขประจำตัวผู้เสียภาษี',
    'set.logoUrl': 'โลโก้บริษัท',
    'set.changeLogo': 'เปลี่ยนโลโก้',
    'set.qcReasons': 'เหตุผล QC ไม่ผ่าน',
    'set.addReason': 'เพิ่มเหตุผลใหม่',
    'set.prodSteps': 'ขั้นตอนการผลิต',
    'set.addStep': 'เพิ่มขั้นตอนใหม่',
    'set.machineStatus': 'สถานะเครื่องจักร',
    'set.addStatus': 'เพิ่มสถานะใหม่',
    'set.general': 'ตั้งค่าทั่วไป',
    'set.regrind': 'เปอร์เซ็นต์เม็ดบด (Regrind %)',
    'set.oeeHours': 'ชั่วโมงทำงานต่อวัน (สำหรับ OEE)',
    'set.roles': 'จัดการบทบาทผู้ใช้งาน',
    'set.addRole': 'เพิ่มบทบาทใหม่',
    'set.overhead': 'รายการค่าใช้จ่ายแฝง (Overhead)',
    'set.addOverhead': 'เพิ่มรายการ',
    'set.totalPerHour': 'รวมต่อชั่วโมง',
    'set.depreciation': 'รายการค่าเสื่อมราคาเครื่องจักร',
    'set.addDepreciation': 'เพิ่มรายการ',
    'set.dataManagement': 'จัดการข้อมูล',
    'set.import': 'นำเข้าข้อมูล (JSON)',
    'set.export': 'ส่งออกข้อมูล (JSON)',
    'set.saveAll': 'บันทึกการเปลี่ยนแปลงทั้งหมด',
    'set.saveSuccess': 'บันทึกข้อมูลเรียบร้อยแล้ว!',
    'set.newItemPlaceholder': 'ระบุข้อมูลใหม่...',
    'set.costName': 'รายการ',
    'set.costValue': 'จำนวน',

    // Common
    'orders.quantity': 'จำนวน',
    'qc.on': 'เมื่อ',
    'qc.inspectedBy': 'ตรวจสอบโดย',
    'qc.pass': 'ผ่าน',
    'qc.fail': 'ไม่ผ่าน',
    'qc.sourceDate': 'วันที่ผลิต',
    'inv.itemName': 'ชื่อรายการ',
    'inv.unit': 'หน่วย',
    'inv.costUnit': 'ทุน/หน่วย',
    'inv.status': 'สถานะ',
    'inv.inStock': 'มีสินค้า',
    'inv.lowStock': 'สินค้าใกล้หมด',
    'inv.outOfStock': 'สินค้าหมด',
    'prod.poNumber': 'เลขที่ PO',
    'prod.productDetail': 'รายละเอียดสินค้า',
    'prod.target': 'เป้าหมาย',
    'prod.produced': 'ผลิตได้',
    'prod.remaining': 'คงเหลือ',
    'prod.progress': 'ความคืบหน้า',
    'prod.dailyLog': 'บันทึกการผลิตรายวัน',
    'prod.dailyLogSub': 'รายงานยอดผลิตรายวัน (แยกตามเครื่อง)',
    'prod.outputToday': 'ยอดวันนี้',
    'prod.accumulated': 'สะสม / เป้าหมาย',
    'prod.statusToday': 'สถานะวันนี้',
    'prod.dailyTotal': 'รวมวันนี้:',
    'prod.noActive': 'ไม่มีใบสั่งผลิตที่กำลังดำเนินการ',
    'prod.noLogs': 'ไม่พบข้อมูลการผลิตในวันที่เลือก',
    'prod.shift': 'กะ',
    'emp.title': 'รายชื่อพนักงาน',
    'emp.subtitle': 'จัดการกำลังคนและการมอบหมายงาน',
    'emp.name': 'ชื่อ',
    'emp.department': 'แผนก',
    'emp.dailyWage': 'ค่าแรงรายวัน',
    'emp.hireDate': 'วันที่เริ่มงาน',
    'dash.totalOrders': 'คำสั่งซื้อทั้งหมด',
    'dash.activeMachines': 'เครื่องจักรทำงาน',
    'dash.totalProduction': 'ยอดผลิตรวม',
    'dash.pendingQC': 'รอตรวจสอบ QC',
    'dash.productionVolume': 'ปริมาณการผลิตตามเครื่องจักร',
    'dash.qcStatus': 'สถานะการตรวจสอบคุณภาพ',
    'dash.recentLogs': 'ประวัติการผลิตล่าสุด',
    'dash.vsLastMonth': 'เทียบเดือนก่อน',
    'dash.ofTotal': 'ของทั้งหมด',
    'orders.title': 'ใบสั่งบรรจุสินค้า',
    'orders.subtitle': 'จัดการคำสั่งซื้อลูกค้าและเป้าหมายการผลิต',
    'orders.search': 'ค้นหาคำสั่งซื้อ...',
    'orders.filter': 'ตัวกรอง',
    'orders.lotNo': 'เลข Lot',
    'orders.productName': 'ชื่อสินค้า',
    'orders.color': 'สี',
    'orders.dueDate': 'กำหนดส่ง',
    'orders.status': 'สถานะ',
    'orders.noFound': 'ไม่พบคำสั่งซื้อที่ตรงกัน',
    'prod.title': 'หน้างานผลิต',
    'prod.subtitle': 'ภาพรวมสถานะเครื่องจักรและความคืบหน้า',
    'prod.activeSummary': 'สรุปใบสั่งผลิตที่กำลังดำเนินการ',
    'inv.title': 'จัดการสต็อกสินค้า',
    'inv.subtitle': 'ติดตามสินค้าสำเร็จรูปและวัตถุดิบ',
    'inv.finishedGoods': 'สินค้าสำเร็จรูป',
    'inv.rawMaterials': 'วัตถุดิบ',
    'inv.searchFinished': 'ค้นหาสินค้า...',
    'inv.searchRaw': 'ค้นหาวัตถุดิบ...',
    'qc.title': 'ตรวจสอบคุณภาพ (QC)',
    'qc.subtitle': 'ตรวจสอบและอนุมัติล็อตการผลิต',

    // Machine Status Specific
    'mach.subtitle': 'ติดตามและควบคุมการผลิตแบบเรียลไทม์',
    'mach.maintSubtitle': 'ตารางการซ่อมบำรุงและประวัติ',
    'mach.running': 'ทำงาน',
    'mach.idle': 'ว่าง',
    'mach.error': 'เสีย',
    'mach.maintenance': 'ซ่อมบำรุง',
    'mach.machineIdle': 'เครื่องจักรว่าง',
    'mach.ready': 'พร้อมรับงาน',
    'mach.lastActive': 'ใช้งานล่าสุด',
    'mach.assign': 'มอบหมายงาน',
    'mach.log': 'บันทึกยอด',
    'mach.settings': 'สถานะ',
    'mach.modalAssign': 'มอบหมายงานผลิต',
    'mach.modalLog': 'บันทึกยอดผลิต',
    'mach.modalStatus': 'สถานะเครื่องจักร',
    'mach.selectOrder': 'เลือกใบสั่งผลิต',
    'mach.operator': 'พนักงานคุมเครื่อง',
    'mach.selectOp': 'เลือกพนักงาน...',
    'mach.currentJob': 'งานปัจจุบัน',
    'mach.goodQty': 'ยอดของดี',
    'mach.rejectQty': 'ยอดของเสีย',
    'mach.setStatus': 'กำหนดสถานะเครื่องจักร',
    'mach.cancel': 'ยกเลิก',
    'mach.confirm': 'ยืนยันรายการ',
    'mach.noOrders': 'ไม่มีใบสั่งผลิตที่เปิดอยู่',
    'mach.statusRun': 'กำลังทำงาน (Running)',
    'mach.statusIdle': 'ว่าง / รอคำสั่ง (Idle)',
    'mach.statusMaint': 'กำลังซ่อมบำรุง (Maintenance)',
    'mach.statusError': 'เครื่องเสีย / ขัดข้อง (Error)',
    'mach.runningNoJob': 'เครื่องทำงาน แต่ยังไม่ได้รับงาน',
    'mach.assignNow': 'มอบหมายงานทันที',

    // PO Doc
    'po.title': 'ใบสั่งผลิต (เอกสาร)',
    'po.subtitle': 'สร้างเอกสารสั่งผลิตเพื่ออนุมัติและเซ็นรับทราบ',
    'po.create': 'สร้างใบสั่งผลิต',
    'po.docNo': 'เลขที่ใบสั่ง',
    'po.date': 'วันที่',
    'po.customer': 'ลูกค้า / แผนก',
    'po.items': 'รายการสินค้า',
    'po.print': 'พิมพ์เอกสาร',
    'po.formTitle': 'แบบฟอร์มใบสั่งผลิต',
    'po.addItem': 'เพิ่มรายการ',
    'po.note': 'หมายเหตุ',
    'po.sign.ordered': 'ผู้สั่งผลิต',
    'po.sign.approved': 'ผู้อนุมัติ',
    'po.sign.received': 'ผู้รับคำสั่ง',
    'po.docHeader': 'ใบสั่งผลิต',
  },
  cn: {
    // Categories
    'nav.overview': '系统概览 (Overview)',
    'nav.sales': '销售与计划 (Sales)',
    'nav.production': '生产线 (Production)',
    'nav.warehouse': '仓库与运输 (Warehouse)',
    'nav.management': '管理与分析 (Management)',
    'nav.welcome': '欢迎',

    // Sub-menus
    'nav.dashboard': '仪表板 (Dashboard)',
    'nav.customers': '客户管理',
    'nav.orders': '生产计划/订单',
    'nav.poDocs': '生产单 (文件)',
    'nav.machineStatus': '机器状态',
    'nav.kanban': '看板 (Kanban)',
    'nav.prodLogs': '生产日志',
    'nav.qc': '质量控制 (QC)',
    'nav.finishedGoods': '成品库存',
    'nav.rawMaterials': '原材料 / BOM',
    'nav.products': '产品管理',
    'nav.shipping': '发货管理',
    'nav.complaints': '客户投诉',
    'nav.employees': '员工管理',
    'nav.maintenance': '机器维护',
    'nav.purchasing': '采购',
    'nav.analysisMat': '材料分析',
    'nav.analysisCost': '成本分析',
    'nav.analysisProfit': '利润分析',
    'nav.oee': '设备效率 (OEE)',
    'nav.reports': '报告',
    'nav.settings': '系统设置',

    // Placeholder
    'common.comingSoon': '即将推出',
    'common.underConstruction': '正在开发中',

    // Settings
    'set.title': '系统设置',
    'set.subtitle': '管理配置',
    'set.saveAll': '保存所有',
    'set.saveSuccess': '保存成功！',
    'set.costName': '项目名称',
    'set.costValue': '成本',
    'set.companyProfile': '公司信息',
    'set.general': '常规设置',
    
    // Common
    'orders.quantity': '数量',
    'qc.pass': '通过',
    'qc.fail': '失败',
    'inv.inStock': '有货',
    'inv.outOfStock': '缺货',
    'prod.progress': '进度',
    
    // Machine Status Specific
    'mach.subtitle': '实时生产监控与控制',
    'mach.maintSubtitle': '维护计划和历史',
    'mach.running': '运行中',
    'mach.idle': '空闲',
    'mach.error': '故障',
    'mach.maintenance': '维护中',
    'mach.machineIdle': '机器空闲',
    'mach.ready': '准备分配',
    'mach.lastActive': '最后活动',
    'mach.assign': '分配任务',
    'mach.log': '记录产量',
    'mach.settings': '设置',
    'mach.modalAssign': '分配工作',
    'mach.modalLog': '记录产出',
    'mach.modalStatus': '机器状态',
    'mach.selectOrder': '选择生产订单',
    'mach.operator': '操作员',
    'mach.selectOp': '选择操作员...',
    'mach.currentJob': '当前工作',
    'mach.goodQty': '良品数量',
    'mach.rejectQty': '不良品数量',
    'mach.setStatus': '设置机器状态',
    'mach.cancel': '取消',
    'mach.confirm': '确认操作',
    'mach.noOrders': '暂无未完成订单',
    'mach.statusRun': '运行中 / 工作中',
    'mach.statusIdle': '空闲 / 等待中',
    'mach.statusMaint': '维护中',
    'mach.statusError': '故障 / 停机',
    'mach.runningNoJob': '机器运行中，无任务',
    'mach.assignNow': '立即分配任务',

    // PO Doc
    'po.title': '生产订单 (文件)',
    'po.subtitle': '创建用于审批的生产文件',
    'po.create': '创建订单',
    'po.docNo': '单号',
    'po.date': '日期',
    'po.customer': '客户',
    'po.items': '项目',
    'po.print': '打印订单',
    'po.formTitle': '生产订单表',
    'po.addItem': '添加项目',
    'po.note': '备注',
    'po.sign.ordered': '订购人',
    'po.sign.approved': '批准人',
    'po.sign.received': '接收人',
    'po.docHeader': '生产订单',
  }
};

const LanguageContext = createContext<LanguageContextType | undefined>(undefined);

export const LanguageProvider: React.FC<{ children: ReactNode }> = ({ children }) => {
  const [language, setLanguage] = useState<Language>('th');

  const t = (key: string): string => {
    return translations[language][key] || key;
  };

  return (
    <LanguageContext.Provider value={{ language, setLanguage, t }}>
      {children}
    </LanguageContext.Provider>
  );
};

export const useTranslation = () => {
  const context = useContext(LanguageContext);
  if (!context) {
    throw new Error('useTranslation must be used within a LanguageProvider');
  }
  return context;
};